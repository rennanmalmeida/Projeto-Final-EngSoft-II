
# üì¶ Sistema de Gest√£o de Estoque - Vdev.0

Um sistema moderno e eficiente para gerenciamento de estoque, desenvolvido com as melhores pr√°ticas de engenharia de software e arquitetura escal√°vel.

## üöÄ Stack Tecnol√≥gica

### Frontend
- **React 18.3.1** - Framework principal para UI
- **TypeScript 5.x** - Linguagem de programa√ß√£o tipada
- **Vite** - Build tool e bundler otimizado
- **Tailwind CSS 3.x** - Framework CSS utility-first
- **Shadcn/UI** - Biblioteca de componentes reutiliz√°veis

### Backend e Infraestrutura
- **Supabase** - BaaS (Backend as a Service)
  - PostgreSQL 15+ - Banco de dados relacional
  - Auth - Sistema de autentica√ß√£o JWT
  - Real-time - WebSockets para atualiza√ß√µes em tempo real
  - Edge Functions - Serverless functions
  - Row Level Security (RLS) - Seguran√ßa em n√≠vel de linha

### State Management e Data Fetching
- **TanStack Query v5** - Cache e sincroniza√ß√£o de estado servidor
- **React Context API** - Gerenciamento de estado global
- **React Hook Form 7.x** - Formul√°rios perform√°ticos

### UI/UX e Intera√ß√£o
- **Lucide React 0.462** - Biblioteca de √≠cones
- **Recharts 2.12** - Gr√°ficos e visualiza√ß√µes
- **Sonner** - Sistema de notifica√ß√µes toast
- **React Router DOM 6.x** - Roteamento client-side

## üèóÔ∏è Arquitetura do Sistema

### Estrutura de Diret√≥rios

```
src/
‚îú‚îÄ‚îÄ components/              # Componentes reutiliz√°veis
‚îÇ   ‚îú‚îÄ‚îÄ auth/               # Autentica√ß√£o e autoriza√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ dashboard/          # Componentes do painel principal
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ charts/         # Gr√°ficos e visualiza√ß√µes
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sections/       # Se√ß√µes espec√≠ficas do dashboard
‚îÇ   ‚îú‚îÄ‚îÄ forms/              # Formul√°rios especializados
‚îÇ   ‚îú‚îÄ‚îÄ inventory/          # Componentes de gest√£o de estoque
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ forms/          # Formul√°rios de movimenta√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ layout/             # Layouts e navega√ß√£o
‚îÇ   ‚îú‚îÄ‚îÄ notifications/      # Sistema de notifica√ß√µes
‚îÇ   ‚îú‚îÄ‚îÄ products/           # Gest√£o de produtos
‚îÇ   ‚îú‚îÄ‚îÄ reports/            # Relat√≥rios e an√°lises
‚îÇ   ‚îú‚îÄ‚îÄ suppliers/          # Gest√£o de fornecedores
‚îÇ   ‚îî‚îÄ‚îÄ ui/                 # Componentes base (Shadcn)
‚îú‚îÄ‚îÄ contexts/               # Contextos React
‚îú‚îÄ‚îÄ hooks/                  # Custom hooks
‚îú‚îÄ‚îÄ integrations/           # Integra√ß√µes externas
‚îÇ   ‚îî‚îÄ‚îÄ supabase/          # Cliente e tipos Supabase
‚îú‚îÄ‚îÄ lib/                    # Utilit√°rios e configura√ß√µes
‚îú‚îÄ‚îÄ pages/                  # P√°ginas da aplica√ß√£o
‚îú‚îÄ‚îÄ services/               # Camada de servi√ßos
‚îú‚îÄ‚îÄ types/                  # Defini√ß√µes TypeScript
‚îî‚îÄ‚îÄ utils/                  # Fun√ß√µes utilit√°rias
```

### Padr√µes Arquiteturais

- **Component-Based Architecture** - Componentes reutiliz√°veis e modulares
- **Custom Hooks Pattern** - L√≥gica reutiliz√°vel encapsulada
- **Service Layer Pattern** - Abstra√ß√£o da camada de dados
- **Repository Pattern** - Acesso consistente aos dados

## üìä Modelagem do Banco de Dados

### Esquema Principal

```sql
-- Tabela de perfis de usu√°rio
profiles (
  id UUID PRIMARY KEY,
  full_name TEXT,
  role TEXT DEFAULT 'employee',
  is_master BOOLEAN DEFAULT false,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT now()
)

-- Tabela de categorias
categories (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  name TEXT NOT NULL,
  description TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now()
)

-- Tabela de produtos
products (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  name TEXT NOT NULL,
  description TEXT,
  quantity INTEGER NOT NULL DEFAULT 0,
  price NUMERIC NOT NULL,
  category_id UUID REFERENCES categories(id),
  category TEXT, -- Campo legado
  image_url TEXT,
  minimum_stock INTEGER DEFAULT 5,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  created_by UUID,
  last_modified_by UUID
)

-- Tabela de fornecedores
suppliers (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name TEXT NOT NULL,
  cnpj VARCHAR,
  contact_name TEXT,
  email TEXT,
  phone TEXT,
  address TEXT,
  notes TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  created_by UUID,
  last_modified_by UUID
)

-- Tabela de relacionamento produto-fornecedor
product_suppliers (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  product_id UUID NOT NULL REFERENCES products(id),
  supplier_id UUID NOT NULL REFERENCES suppliers(id),
  created_at TIMESTAMP WITH TIME ZONE DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT now()
)

-- Tabela de movimenta√ß√µes de estoque
stock_movements (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  product_id UUID NOT NULL REFERENCES products(id),
  quantity INTEGER NOT NULL,
  type TEXT NOT NULL CHECK (type IN ('in', 'out')),
  date TIMESTAMP WITH TIME ZONE DEFAULT now(),
  supplier_id UUID REFERENCES suppliers(id),
  notes TEXT,
  user_id UUID,
  created_by UUID,
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT now()
)
```

### Fun√ß√µes do Banco de Dados

#### Estat√≠sticas e Analytics
- `get_dashboard_stats()` - M√©tricas principais do dashboard
- `get_movements_summary(days)` - Resumo de movimenta√ß√µes por per√≠odo
- `get_category_analysis()` - An√°lise por categorias
- `get_low_stock_products()` - Produtos com estoque baixo

#### Valida√ß√£o e Controle
- `validate_stock_movement()` - Valida√ß√£o de movimenta√ß√µes
- `get_current_stock()` - Estoque atual de produto
- `handle_stock_movement_simple()` - Trigger para atualiza√ß√£o autom√°tica

#### Autoriza√ß√£o
- `get_user_role()` - Papel do usu√°rio
- `is_admin_or_master()` - Verifica√ß√£o de permiss√µes administrativas

## üîß Custom Hooks

### Hooks de Dados
- `useProducts()` - Gest√£o de produtos (CRUD + cache)
- `useCategories()` - Gest√£o de categorias
- `useSuppliers()` - Gest√£o de fornecedores
- `useStockMovements()` - Movimenta√ß√µes de estoque

### Hooks de Estado
- `useDashboard()` - Estado do dashboard
- `useOptimizedDashboard()` - Dashboard otimizado
- `useProfile()` - Perfil do usu√°rio
- `useAuthorization()` - Controle de acesso

### Hooks de Tempo Real
- `useRealtimeStock()` - Estoque em tempo real
- `useRealTimeNotifications()` - Notifica√ß√µes live

### Hooks de UI
- `use-mobile()` - Detec√ß√£o de dispositivos m√≥veis
- `use-toast()` - Sistema de notifica√ß√µes
- `useSimpleForm()` - Formul√°rios simplificados

## üé® Sistema de Design

### Tokens de Design
```css
/* Cores sem√¢nticas definidas em index.css */
--primary: 222.2 84% 4.9%
--secondary: 210 40% 98%
--muted: 210 40% 96%
--accent: 210 40% 96%
--destructive: 0 84.2% 60.2%
```

### Componentes UI Base (Shadcn/UI)
- **Layout**: Card, Sheet, Dialog, Popover
- **Formul√°rios**: Input, Select, Checkbox, Radio
- **Navega√ß√£o**: Button, Breadcrumb, Tabs
- **Feedback**: Toast, Alert, Progress, Skeleton
- **Dados**: Table, Badge, Avatar

### Componentes Customizados
- **Layouts Responsivos**: MobileLayout, MobileOptimizedLayout
- **Inputs Especializados**: CurrencyInput, CepInput, CnpjInput
- **Visualiza√ß√µes**: Charts (Recharts), CategoryDisplay

## üîê Sistema de Seguran√ßa

### Autentica√ß√£o
- **JWT Tokens** via Supabase Auth
- **Row Level Security (RLS)** em todas as tabelas
- **Pol√≠ticas de acesso** baseadas em roles

### Autoriza√ß√£o
```typescript
// N√≠veis de acesso
type UserRole = 'employee' | 'admin' | 'developer'

// Usu√°rios master permanentes
const PERMANENT_ADMINS = [
  '7d2afaa5-2e77-43cd-b7fb-d5111ea59dc4',
  'a679c5aa-e45b-44e4-b4f2-c5e4ba5333aa'
]
```

### Valida√ß√£o de Dados
- **Zod schemas** para valida√ß√£o de formul√°rios
- **Valida√ß√£o server-side** em edge functions
- **Sanitiza√ß√£o** de inputs do usu√°rio

## üì° API e Servi√ßos

### Camada de Servi√ßos
```typescript
// Estrutura dos servi√ßos
services/
‚îú‚îÄ‚îÄ api.ts                 # Servi√ßo principal (compatibilidade)
‚îú‚îÄ‚îÄ products.service.ts    # CRUD de produtos
‚îú‚îÄ‚îÄ categories.service.ts  # Gest√£o de categorias
‚îú‚îÄ‚îÄ suppliers.service.ts   # Gest√£o de fornecedores
‚îú‚îÄ‚îÄ stockMovements.service.ts # Movimenta√ß√µes
‚îú‚îÄ‚îÄ cacheService.ts       # Sistema de cache
‚îú‚îÄ‚îÄ optimizedApi.ts       # APIs otimizadas
‚îî‚îÄ‚îÄ stockService.ts       # Controle de estoque
```

### Cache e Performance
- **Cache em mem√≥ria** com TTL configur√°vel
- **Invalida√ß√£o autom√°tica** em muta√ß√µes
- **Debounce e throttle** em buscas
- **Lazy loading** de componentes

### Real-time Features
- **WebSockets** via Supabase Realtime
- **Atualiza√ß√µes autom√°ticas** de estoque
- **Notifica√ß√µes em tempo real**

## üì± Responsividade Mobile

### Breakpoints
```css
sm: 640px   /* Tablets pequenos */
md: 768px   /* Tablets */
lg: 1024px  /* Laptops */
xl: 1280px  /* Desktops */
2xl: 1536px /* Monitores grandes */
```

### Componentes Mobile-First
- `MobileLayout` - Layout otimizado para mobile
- `MobileCard` - Cards responsivos
- `MobileGrid` - Grid adaptativo
- `useIsMobile()` - Hook para detec√ß√£o de dispositivo

## üöÄ Funcionalidades Principais

### üìä Dashboard Inteligente
- M√©tricas em tempo real
- Gr√°ficos interativos (Recharts)
- An√°lise de categorias
- Alertas de estoque baixo
- Compara√ß√£o temporal

### üì¶ Gest√£o de Produtos
- CRUD completo com valida√ß√£o
- Upload de imagens
- Controle de estoque m√≠nimo
- Categoriza√ß√£o UUID-based
- Busca e filtros avan√ßados

### üè≠ Gest√£o de Fornecedores
- Cadastro completo com valida√ß√£o CNPJ
- Relacionamento N:N com produtos
- Hist√≥rico de movimenta√ß√µes

### üìà Relat√≥rios e Analytics
- Relat√≥rios de movimenta√ß√µes
- An√°lise de valor de estoque
- Distribui√ß√£o por categorias
- Gr√°ficos temporais

### üîî Sistema de Notifica√ß√µes
- Toast notifications (Sonner)
- Alertas em tempo real
- Notifica√ß√µes de estoque baixo

## üõ†Ô∏è Otimiza√ß√µes Implementadas

### Performance
- **React Query** com cache inteligente
- **Lazy loading** de rotas e componentes
- **Memoiza√ß√£o** de c√°lculos pesados
- **Debounce** em buscas (300ms)
- **Virtual scrolling** em listas grandes

### SEO e Acessibilidade
- **Semantic HTML** em todos os componentes
- **ARIA labels** e roles apropriados
- **Contraste adequado** (WCAG 2.1)
- **Navega√ß√£o por teclado**
- **Screen reader friendly**

### Seguran√ßa
- **Content Security Policy (CSP)**
- **XSS Protection**
- **CSRF Protection** via Supabase
- **Input sanitization**
- **SQL Injection prevention** (ORM)

## üìã Scripts Dispon√≠veis

```bash
# Desenvolvimento
npm run dev          # Servidor de desenvolvimento (porta 8080)
npm run build        # Build para produ√ß√£o
npm run preview      # Preview da build

# Qualidade de C√≥digo
npm run lint         # ESLint
npm run type-check   # TypeScript check

# Supabase
npx supabase start   # Iniciar Supabase local
npx supabase stop    # Parar Supabase local
npx supabase status  # Status dos servi√ßos
```

## üß™ Conven√ß√µes de C√≥digo

### Nomenclatura
```typescript
// Componentes: PascalCase
export const ProductCard: React.FC = () => {}

// Hooks: camelCase com prefixo 'use'
export const useProducts = () => {}

// Tipos: PascalCase
interface ProductFormData {}

// Constantes: UPPER_SNAKE_CASE
const API_BASE_URL = 'https://api.example.com'

// Fun√ß√µes: camelCase
const formatCurrency = (value: number) => {}
```

### Estrutura de Componentes
```typescript
interface ComponentProps {
  // Props tipadas com JSDoc
  /** T√≠tulo do componente */
  title: string
  /** Callback opcional */
  onAction?: () => void
}

export const Component: React.FC<ComponentProps> = ({ 
  title, 
  onAction 
}) => {
  // 1. Hooks de estado
  const [state, setState] = useState()
  
  // 2. Hooks de dados
  const { data, isLoading } = useQuery()
  
  // 3. Handlers e efeitos
  const handleClick = useCallback(() => {}, [])
  
  // 4. Early returns
  if (isLoading) return <Skeleton />
  
  // 5. Render principal
  return (
    <div className="component-wrapper">
      {/* JSX */}
    </div>
  )
}
```

## üîÑ Fluxo de Dados

### Arquitetura de Estado
```
User Interaction
       ‚Üì
   Component
       ‚Üì
  Custom Hook
       ‚Üì
   Service Layer
       ‚Üì
  Supabase Client
       ‚Üì
   PostgreSQL
```

### Cache Strategy
```typescript
// N√≠veis de cache
1. React Query Cache (3-5 min)
2. Service Layer Cache (1-10 min)
3. Browser Cache (HTTP headers)
4. CDN Cache (Vercel)
```

## üåü Roadmap Futuro

### Funcionalidades Planejadas
- [ ] PWA (Progressive Web App)
- [ ] Modo offline com sincroniza√ß√£o
- [ ] API REST p√∫blica
- [ ] Integra√ß√£o com ERPs externos
- [ ] App mobile nativo (React Native)
- [ ] IA para previs√£o de estoque
- [ ] Relat√≥rios avan√ßados (PDF/Excel)
- [ ] Multi-tenancy

### Melhorias T√©cnicas
- [ ] Micro-frontends
- [ ] GraphQL integration
- [ ] Redis para cache distribu√≠do
- [ ] Monitoring com Sentry
- [ ] CI/CD com GitHub Actions
- [ ] Testes E2E com Playwright

## üöÄ Deploy e Infraestrutura

### Ambientes
- **Desenvolvimento**: Local com Supabase local
- **Staging**: Vercel Preview + Supabase Staging
- **Produ√ß√£o**: Vercel Production + Supabase Production

### Pipeline de Deploy
```yaml
# Automatizado via Vdev.0
1. Push to main
2. Build & Type check
3. Run tests
4. Deploy to Vercel
5. Update Supabase migrations
6. Health checks
```

## üìä Monitoramento

### M√©tricas Principais
- **Performance**: Core Web Vitals
- **Erros**: Error boundaries + logging
- **Uso**: Analytics de funcionalidades
- **Performance**: Bundle size tracking

### Logs e Debugging
```typescript
// SecureLogger para logs estruturados
SecureLogger.info('User action', { 
  userId, 
  action: 'create_product',
  timestamp: new Date().toISOString()
})
```

## ü§ù Contribui√ß√£o

### Workflow de Desenvolvimento
1. Fork do reposit√≥rio
2. Branch feature (`git checkout -b feature/nova-funcionalidade`)
3. Commit das mudan√ßas (`git commit -m 'feat: adiciona nova funcionalidade'`)
4. Push para branch (`git push origin feature/nova-funcionalidade`)
5. Pull Request

### Padr√µes de Commit
```
feat: nova funcionalidade
fix: corre√ß√£o de bug
docs: documenta√ß√£o
style: formata√ß√£o
refactor: refatora√ß√£o
test: testes
chore: manuten√ß√£o
```

## üìÑ Licen√ßa

Este projeto est√° sob a licen√ßa MIT. Veja o arquivo [LICENSE](LICENSE) para mais detalhes.

## üë• Equipe de Desenvolvimento

- **Arquiteto Principal**: Victor Gabriel Carvalho Pereira
- **Stack**: React + TypeScript + Supabase
- **Metodologia**: Agile + Clean Architecture
- **Ferramentas**: Vdev.0 + GitHub + Vercel

## üìû Suporte e Documenta√ß√£o

- üìß **Email**: suporte@vdev0.com
- üí¨ **Discord**: [Servidor Vdev.0](https://discord.gg/vdev0)
- üìñ **Docs**: [docs.vdev0.com](https://docs.vdev0.com)
- üêõ **Issues**: [GitHub Issues](https://github.com/vdev0/issues)

---

**Desenvolvido com ‚ù§Ô∏è usando Vdev.0 e as melhores pr√°ticas de engenharia de software**

## üîó Links √öteis

- [Vdev.0 Platform](https://vdev0.dev)
- [React Documentation](https://react.dev)
- [TypeScript Handbook](https://www.typescriptlang.org/docs)
- [Supabase Docs](https://supabase.com/docs)
- [Tailwind CSS](https://tailwindcss.com/docs)
- [TanStack Query](https://tanstack.com/query)

